- name: Yum update
  yum:
    update_cache: yes

- name: Install docker
  shell: yum install -y docker-{{ docker_version }}

- name: Install docker-compose
  shell: |
    curl -L "https://github.com/docker/compose/releases/download/{{ docker_compose_version }}/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
    chmod +x /usr/local/bin/docker-compose
    ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
  args:
    creates: /usr/local/bin/docker-compose

- name: Add the user ec2-user to docker group
  user:
    name: ec-user
    groups: docker
    append: yes